---
title: "Like Tennis's One-Handed Backhand? It Could Be Gone From The Men's Top Game By 2030"
author: ''
date: '2019-05-04'
slug: tennis-one-handed-backhand
categories: []
tags: []
---


```{r results='asis', echo=FALSE, include=FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(lubridate)
library(hrbrthemes)
library(ggthemes)
library(scales)
library(plotly)
theme_set(theme_ipsum_rc() +
          theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
          theme(axis.title.y = element_text(angle = 0)))
load("C:/Users/nyulo/Documents/HBS/LM/tennis_rankings/data/atp_top_100.R")
```


As a tennis fan, I recently came across an [article](http://www.espn.com/tennis/story/_/id/10475414/tennis-resurgence-one-handed-backhand) from ESPN on "the resurgence of the one-handed backhand." I've long been a fan of this shot and worried about its future in tennis, as we seem to be seeing less and less of it as each subsequent season passes. But after noticing that the ESPN article lacked sufficent empirical analysis, I set out to answer the question myself: is the one-handed backhand actually experiencing a resurgence?


## About The Dataset

I scraped data from the [ATP World Tour](https://www.atptour.com/en/rankings/singles) website from 1980 through 2019. I was delighted to see that the player names & ranking information were complete.

```{r}
is.na(clean$Ranking) %>% sum
is.na(clean$Player) %>% sum
```


However, there were a substantial amount of missing values in the variable describing what type of backhand a player hit.

```{r}
clean %>% 
  filter(!str_detect(strokes,"One-Handed|Two-Handed")) %>% 
  pull(Player) %>% 
  unique() %>% 
  length()
```

Looks like we're missing information for 610 unique players, and I suspected it might be the older data which accounted for the majority of the missings. We can inspect this with overlaid density plots of dates, colored by whether or not an observation is missing:

```{r results='asis', echo= TRUE}

p2 <- clean %>% 
  ggplot(aes(year, fill = is.na(one_hander))) +
  geom_density(alpha = .6) +
  labs(title = "Distribution of Missing Backhand Type by Year",
       fill = "Missing?")

ggplotly(p2)
```

Perhaps more problematic is that the missing backhand information is correlated with rank; lower ranked players were more likely to contain missing backhand types:

```{r}

p3 <- clean %>% 
  mutate(Ranking = parse_number(Ranking)) %>% 
  group_by(Ranking) %>% 
  summarize(missing_share = sum(is.na(one_hander))) %>% 
  ggplot(aes(Ranking, missing_share)) +
  geom_line(size = 1.7) +
  expand_limits(y = 0) +
  scale_x_continuous(breaks = c(1,10,20,30,40,50,60,70,80,90,100)) +
  labs(title = "Sum of Missing Counts By Ranking")

ggplotly(p3)
```

Sure, 610 players isn't terribly hard to, well, hard code. But I'll leave that for someone else to do should they feel so inclined (email me!). Despite these shortcomings I pushed on while filtering for dates from 2000 onwards.

# ONE HANDED BACKHAND SHARE BY YEAR


```{r, message = FALSE}
p4 <- clean %>% 
  filter(year >= 2000) %>% 
  group_by(date) %>% 
  summarize(share = mean(one_hander, na.rm = TRUE)) %>% 
  ggplot(aes(date, share)) +
  geom_smooth(size = 1.7) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()) +
  labs(x = "", y = "", color = "", title = "Share of One-Handers by Year, 95% CI's Shown",
       subtitle = "test")

ggplotly(p4)
```

Above we see that undoubtedly, the share of tennis players in the ATP Top 100 is in steady decline.


# ONE HANDED BACKHAND RATE: TOP 50 VS 51 - 100

```{r}
p5 <- clean %>% 
  filter(year >= 2000) %>% 
  group_by(year, rank_cohort) %>% 
  summarize(share = mean(one_hander, na.rm = TRUE)) %>% 
  ggplot(aes(year, share, color = as.factor(rank_cohort))) +
  geom_smooth(se = FALSE, size = 1.7) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()) +
  scale_y_percent() +
  labs(x = "", y = "", color = "", title = "Percent of One Handed Backhands in ATP Top 100")

ggplotly(p5)
```

# Again

```{r results='asis', echo=FALSE}
# ONE HANDED BACKHAND - EXTENDED MODEL
p6 <- clean %>% 
  filter(year >= 2000) %>% 
  group_by(year) %>% 
  summarize(share = mean(one_hander, na.rm = TRUE)) %>% 
  ggplot(aes(year, share)) +
  geom_point(size = 2) +
  stat_smooth(method = "lm", fullrange = TRUE) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()) +
  expand_limits(y = 0) +
  xlim(c(2000,2030)) +
  geom_hline(yintercept = 0, linetype = 2) +
  labs(x = "", y = "", color = "", title = "Average Share of One-Handers in ATP Top 100 by Year")

ggplotly(p6)
```